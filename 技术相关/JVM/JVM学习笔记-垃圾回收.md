# 垃圾回收

## 1. 如何判断对象可以回收

### 1.1 引用计数法



### 1.2 可达性分析算法

- Java 虚拟机中的垃圾回收器采用**可达性分析算法**来探索所有**存活**的对象
- 扫描**堆**中的对象，看看是否能够沿着 **GC Root 对象**为起点的**引用链**找到该对象，找不到则表示可以回收

### 1.3 五种引用

- 强引用
  - 只有**所有**的 GC Root 对象都不通过**强引用**引用该对象时，该对象才能被垃圾回收
- 软引用（SoftReference）
  - 仅有**软引用**引用该对象时，在垃圾回收后，内存仍不足时会再次发出垃圾回收，回收软引用对象
  - 可以配合**引用队列**来释放软引用自身（软引用自身也是个对象）
- 弱引用（WeakReference）
  - 仅有**弱引用**引用该对象时，在垃圾回收后，无论内存是否充足，都会回收弱引用读写
  - 可以配合**引用队列**来释放弱引用自身（弱引用自身也是个对象）
- 虚引用（PhantomReference）
  - **必须**配合**引用队列**使用，主要配合 ByteBuffer 使用，被引用对象回收时，会将虚引用入队，由 Reference Handler 线程调用虚引用相关方法释放**直接内存**（因为 JVM 不能操作直接内存）
- 终结器引用（FinalReference）
  - 无需手动编码，但其内部配合引用队列使用，在垃圾回收时，终结器引用入队（被引用对象暂时没有被回收），再由 Finalizer 线程通过终结器引用找到被引用对象，并调用它们的 finalize 方法，第二次垃圾回收时才能回收被引用的对象

## 2. 垃圾回收算法

## 2.1 标记清除



### 2.2 标记整理



### 2.3 复制