---
title: 【期末复习】数据库期末复习
date: '2019/12/30 12:13:22'
categories: 期末复习
tags: 期末复习
abbrlink: 17530
---

大三上学期期末从各路收集来的以及根据老师上课所将的内容写的数据库复习总结。

<!--more-->

# 第一章:数据库概述

## 1.2 数据库管理技术的发展(简答或选择)

**经历了管理文件和数据库管理两个阶段**

- 文件管理的**缺点**：
  - 编写应用程序不方便
  - 数据冗余不可避免
  - 应用程序依赖性
  - 不支持文件的并发访问
  - 数据间联系弱
  - 难以满足不同用户对数据的需求
  - 无安全控制功能
- 数据库管理的**优点**：
  - 相互关联的数据集合
  - 较少的数据冗余
  - 程序与数据相互独立
  - 保证数据的安全可靠
  - 最大限度地保证数据的正确性
  - 数据可以共享并能保证数据的一致性



## 1.3:数据独立性（简答或填空）

数据独立性包含两个方面：

- 物理独立性
  - 当数据的存储位置或存储结构发生变化时，不影响应用程序的特性
- 逻辑独立性
  - 当表达现实世界的信息内容发生变化时，也不影响应用程序的特性，如增加列、删除无用列

## 1.4:数据库系统的组成（简答或选择）

数据库系统是基于数据库的计算机应用系统，包含三个部分：

- 数据库：数据的汇集，它以一定的组织形式保存在存储介质上
- 数据库管理系统（以及相应的实用工具）：管理数据库的系统软件，可以实现数据库系统的各种功能
- 应用程序：专指以数据库数据为基础的程序

## 习题

### 3.与文件管理相比，应用程序是否需要关心数据的存储位置和存储结构？为什么？

不需要。因为在数据库系统中，数据的存储位置以及存储结构保存在数据库管理系统中，从数据到物理存储位置的转换是由数据库管理系统自动完成的。

### 7. 数据库独立性指的是什么？它能带来哪些好处？

数据库独立性是指物理独立性和逻辑独立性。物理独立性的好处是当数据的存储位置或存储结构发生变化时，不影响应用程序的特性；逻辑独立性的好处是当表达现实世界的信息内容发生变化时，也不影响应用程序的特性。

### 8.数据库系统由哪几部分组成，每一部分在数据库系统中作用大致是什么？

数据库系统由三个主要部分组成，数据库、数据库管理系统、应用程序。

数据库：数据的汇集，它以一定的组织形式保存在存储介质上

数据库管理系统（以及相应的实用工具）：管理数据库的系统软件，可以实现数据库系统的各种功能

应用程序：专指以数据库数据为基础的程序

# 第二章:数据模型与数据库系统结构

## 习题

### 6. 数据库系统包含哪三级模式？分别说明每一级模式的作用。

- 内模式：是对整个数据库的底层表示，描述了数据的存储结构
- 模式：是数据库中全体数据的逻辑结构和特征的描述，是所有用户的公共数据视图
- 外模式：对现实系统中用户感兴趣的整体数据结构的局部描述，用于满足不同数据库用户需求的数据视图，是数据库用户能够看见和使用的局部数据的逻辑结构和特征的描述，是对数据库整体数据结构的子集或局部重构

### 7. 数据库管理系统的提供的两级映像的作用是什么？它带来哪些功能？

- 模式与内描述间的映像

  模式/内模式的映像定义了概念视图和存储的数据库的对应关系，说明了概念层的记录和字段在内部怎样表示。如果数据库的存储结构改变了，那么必须对模式/内模式的映像进行需要的调整，使模式可以保持不变

- 外模式与模式间的映像

  定义了特定的外部视图和概念视图之间的对应关系，当概念模式的结构可发送改变时，也可以通过调整外模式/模式间的映像关系，使外模式可以保持不变

# 第三章:关系数据库

## 习题

### 2. 解释下列术语的含义：

- 笛卡尔积：

```math
   设D1,D2,...,Dn为任意集合,
   D1 \times D2 \times ... \times Dn = (d1,d2,...,dn)|di \in Di,  i=1,2,...,n
```

- 主键：表中的属性或属性组，用于唯一地确定一个元组
- 候选键：能够唯二标识一个关系的元组而又不包含多余的属性
- 外键：如果公共关键字在一个关系中是主关键字，那么这个公共关键字被称为另一个关系的外键
- 关系：二维表
- 关系模式：二维表的表框或表头结构
- 关系数据库：对应于一个关系模型的所有关系的集合

### （重点）3. 关系数据库的三个完整性的约数是什么？各是什么含义？

- 实体完整性:关系数据库中所有的表都有主键,且表中不允许存在无主键值或主键值相同的记录
- 参照完整性:用于描述实体之间的关系
- 用户定义完整性:指明关系中的属性的取值范围,即保证数据库中数据符合现实意义

   

# 第五章:数据库类型及关系表创建

   SQL 按其功能可分为四大部分

- 数据定义功
- 数据控制功
- 数据查询功能
- 数据操作功能

# 第六章:数据库操作语句

- 对查询结果进行排序

```sql
   order by <列名> [asc | desc] [, ...n ]
```

- 对查询结果进行分组统计

```sql
   group by <分组依据列> [, ...n ]
```

```sql
   -- 统计每门课程的选课人数,列出课程号和选课人数
   select Cno as 课程号, count(Sno) as 选课人数 from SC group by Cno
   
   -- 统计每个系的女生人数
   select Sdept, count(*) 女生人数 from Student where Ssex = '女' group by Sdept
```

- 确定范围

```sql
   列名|表达式 [not] between 下限值 and 上限值
```

```sql
   -- 查询年龄在 20 ~ 30 岁之间的学生的姓名,所在系和年龄
   select Sname, Sdept, Sage from Student where Sage between 20 and 30
   -- 等价于:select Sname, Sdept, Sage from Student where Sage>=20 and Sage<=30
   
   -- 查询年龄不在 20 ~ 30 岁之间的学生的姓名,所在系和年龄
   select Sname, Sdept, Sage from Student where Sage not between 20 and 30
```

- 确定集合

```sql
   列名 [not] in (常量1, 常量2, ...)
```

```sql
   -- 查询信息系,数学系和计算机系学生的姓名和性别. 注意:字符串用单引号
   select Sname, Ssex from Student where Sdept in ('信息系', '数学系', '计算机系');
```

- 字符串匹配 (LIKE)
  - _  : 匹配任意一个字符
  - %  : 匹配 0 个或多个字符
  - [] : 匹配 [] 中的任意一个字符
  - [^]: 不匹配 [] 中的任意一个字符

   like 用于查找指定列中与匹配串匹配的元组

```sql
   列名 [not] like <匹配串>
```

```sql
   -- 查询姓"张"的学生的详细信息
   select * from Student where Sname like '张%'
   
   -- 查询姓"张","李","刘"的学生的详细信息
   select * from Student where Sname like '[张李刘]%'
```

- 多表连接查询

  - 内连接

  ```sql
  from 表1 join 表2 on <连接条件>
  ```

  ```sql
  -- 查询每个学生及其选课的详细信息
  -- 由于学生的基本信息放在 Student 表中,学生选课信息放在 SC 表中,因此这个查询涉及两个表,两个表之间进行连接的连接条件是这两个表中的 Sno 相等
  select * from Student join sc on Student.Sno = SC.Sno -- 将 Student 表和 SC 表连接起来
  ```

- 嵌套子查询

```sql
   -- 查询没选"c01"课程的学生姓名和所在系
   select Sname, Sdept from Student where Sno in (select Sno from SC where Cno != 'c01')
```

- 将查询结果保存到新表中

```sql
   -- 将计算机系的学生信息保存到 #ComputerStudent 局部临时表中
   select * into #ComputerStudent from Student where Sdept = '计算机系'
```

- 插入数据

```sql
   insert into Student values(12345, '老逼杰', '男', 18, '电子系')
```

- 更新数据

```sql
   update Student set Sage = Sage + 1
   
   update Student set Sage = 21 where Sno = '12345'
   
   -- 计算机系全体学生的成绩加 5 分
   update SC set Grade = Grade + 5
       where Sno in (select Sno from Stduent
           where Sdept = '计算机系')
```

- 删除数据

```sql
   delete from SC where Grade < 60
```

# 第七章:索引和视图

## 7.1 索引

### 7.1.1 基本概念

### 7.1.2 索引的存储结构及分类 (考点)

   索引分为两大类

- 聚集索引: 对数据按索引关键字进行物理排序
  - 聚集索引的项的值按物理排序
- 非聚集索引: 不对数据进行物理排序
  - 数据不按非聚集索引关键字值的顺序排序和存储
  - 非聚集索引的叶级节点不是存放数据的数据页

## 7.2 视图

   **外模式对应到关系数据库中的概念就是视图**
       

### 7.2.5 视图的作用 (题)

- 简化数据查询语句
- 使用户能从多角度看待同一数据
- 提高了数据的安全性
- 提供了一定程度的逻辑独立性

## 小结

- 在一个表中只能建立一个索引,但能建立多个非聚集索引
- 建立索引是为了加快数据的查询速度
- 建立聚集索引时,数据库管理系统首先按聚集索引列的值对数据进行物理排序
- 视图是基于数据库基本表的虚表,视图所包含的数据并不被物理存储,视图的数据全部来自于基本表
- **通过视图访问数据比直接从基本表访问数据效率会低一些**

## 习题

### 10. 说明视图的好处.

- 简化数据查询语句
- 使用户能从多角度看待同一数据
- 提高了数据的安全性
- 提供了一定程度的逻辑独立性

### 11. 使用视图可以加快数据查询的速度,这句话对吗?为什么?

   这句话不对.通过视图访问数据比直接从基本表访问数据效率会低一些,因为它多了一层转换操作,即从外模式转到模式.

# 第九章:事务与并发控制

## 9.1 事务

### 9.1.1 基本概念

   **事务是用户定义的数据操作系列,这些操作作为一个完整的工作单元执行.一个事务内的所有语句作为一个整体,要么全部执行,要么全部不执行.**

### 9.1.2 事务的特征

- 原子性
- 一致性
- 隔离性
- 持久性

   

   

# 第十章:数据库设计

## 例 10.3  有 m:n 联系的 E-R 模型如图所示,请将其转化为合适的关系模式.

![](https://gitee.com/weizujie/Img/raw/master/img/有mn联系的ER模型如图所示,请将其转化为合适的关系模式.png)

   教师(教师号, 教师名, 职称), "教师号"为主键.

   课程(课程号, 课程名, 学分), "课程号"为主键.

   授课(教师号, 课程号, 授课时数), (教师号, 课程号)为主键

   同时"教师号"为引用"教师"关系模式的教师号的外键, "课程号"为引用课程关系模式的课程号的外键

   

# 第十一章:存储过程和触发器

## 11.3 触发器

   触发器是一种特殊的存储过程,其特殊性在与它不需要由用户调用执行,而是在用户对表中数据进行 UPDATE, INSERT 或 DELETE 操作时自动触发执行的.

### 11.3.1 创建触发器

   在触发器中科院和私用两个特殊的零时表: INSERTED 表和 DELETED 表,这两个表的构建同建立触发器的表的结构完全相同,而且这两个临时表只能用在触发器代码中.

- INSERTED 表保存了 INSERT 操作中新插入的数据和 UPDATE 操作中更新后的数据
- DELETED 保存了 DELETED 操作删除的数据和 UPDATE 操作中更新前的数据

## 小结

   **(选择/填空) 引发触发器的操作可以是对数据的增删改操作**

# 第十二章:函数和游标

## DATEDIFF (考试)

   作用:返回两个指定日期之间相差的日期

```sql
   datediff(datepart, start_date, end_date)
```

```sql
   -- 计算 2016年1月1日 到 2016年6月15日 之间的天数
   select datediff(DAY, '2016/1/1', '2016/6/15')
   -- 执行结果: 165
```

# 第十四章:备份和恢复数据库

## 14.1.3 SQL Server 支持的备份类型

- 完整备份:将数据库的全部内容均备份下来,对数据进行的第一个备份必须是完整备份
- 差异备份
- 事务日志备份

## 14.2.1 恢复数据库的顺序

1. 恢复最近完整备份
2. 恢复完整备份之后最后一次差异备份(如果有的话)
3. 按事务日志备份的先后顺序恢复自完整备份或差异备份之后的所有日志备份

# 其他习题


## 查询今天加上100天后的新的日期

```sql
   SELECT DATEADD(day,100, getdate() FROM 日期表;
```

## 计算 2016年1月1日 到 2016年6月15日 之间的天数

```sql
   select datediff(DAY, '2016/1/1', '2016/6/15')
```

   

## 查询全体学生不同的姓氏

```sql
select distinct left(姓名, 1) from 学生表;
```

## 查询学生姓名、学号的后五位和所在系

```sql
   select 姓名, right(学号, 5), 系别 from 学生表;
```

## 查询学生姓名和姓名的汉字个数

```sql
   select 姓名, len(姓名) from 学生表;
```

## 查询名字的第二个字是“小”或是“大”的学生姓名、性别和所在系

```sql
select 姓名, 性别, 系 from 学生表 where 姓名 like '%小%' or 姓名 like '%大%'
```